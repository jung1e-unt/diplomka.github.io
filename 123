private static void ApplyDateColumnFormats2(IXLWorksheet ws, DataTable dt)
{
    var timeColumns = new HashSet<string>(StringComparer.OrdinalIgnoreCase)
    {
        "TIMES_NACH", "TIMES_KON", "T1", "VREMYA"
    };

    for (int i = 0; i < dt.Columns.Count; i++)
    {
        var col = dt.Columns[i];

        if (col.DataType != typeof(DateTime))
            continue;

        if (!timeColumns.Contains(col.ColumnName))
            continue;

        var xlCol = ws.Column(i + 1);

        foreach (var cell in xlCol.CellsUsed().Skip(1)) // пропускаем заголовок
        {
            if (cell.Value is DateTime dtVal)
            {
                // КЛЮЧЕВОЕ МЕСТО
                cell.Value = dtVal.TimeOfDay;
            }
        }

        xlCol.Style.NumberFormat.Format = "hh:mm";
    }
}
